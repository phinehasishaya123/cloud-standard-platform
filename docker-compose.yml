version: '3.8'  # The dialect of Docker Compose we are using

services:       # A list of the "machines" we want to run
# Service 1: Your Public Website (The "Hello World" Page)
  my-web-server:                # Name of our service
    build: ./app             # ðŸ‘ˆ Build the Dockerfile in the 'app' folder
    container_name: production-website
    restart: always
    ports:
      - "80:5000"            # ðŸ‘ˆ Map VM Port 80 to Container Port 5000 (Flask)
    # We don't need volumes for code anymore because it's baked into the image

# Service 2: The Monitoring Dashboard (Uptime Kuma)
  uptime-kuma:
    image: louislam/uptime-kuma:1
    container_name: monitoring-dashboard
    restart: always
    ports:
      - "3001:3001"  # Access this on Port 3001
    volumes:
      - uptime-kuma-data:/app/data

# Define a storage volume for the dashboard so it remembers data if it restarts
volumes:
  uptime-kuma-data:
