services:
      
      production-website:
        build: ./app
        container_name: production-website
        restart: always
        ports:
          - "80:5000"
        environment:
          # IMPORTANT: Use the SERVICE NAME as the host
          DB_HOST: company-database 
          POSTGRES_DB: ${DB_NAME}
          POSTGRES_USER: ${DB_USER}
          # Use a strong, known password here. Let's make it simple for the lab:
          POSTGRES_PASSWORD: ${DB_PASSWORD}
        depends_on:
          # ENSURE the app waits for the DB to be healthy
          company-database:
            condition: service_healthy
    
      company-database:
        image: postgres:13-alpine
        container_name: company-database
        # ... (rest of the DB config remains the same) ...
        restart: always
        volumes:
          - company_data:/var/lib/postgresql/data
        environment:
          POSTGRES_DB: ${DB_NAME}
          POSTGRES_USER: ${DB_USER}
          # ENSURE this password matches the one in production-website environment block!
          POSTGRES_PASSWORD: ${DB_PASSWORD}
        healthcheck:
          test: ["CMD-SHELL", "pg_isready -U user"]
          interval: 5s
          timeout: 5s
          retries: 5
      monitoring-dashboard:
        image: louislam/uptime-kuma:1
        container_name: monitoring-dashboard
        restart: always
        ports:
          - "3001:3001"
        volumes:
          - ./monitoring-data:/app/data

volumes: 
  company_data:    
      # ... (monitoring-dashboard service remains the same) ...
